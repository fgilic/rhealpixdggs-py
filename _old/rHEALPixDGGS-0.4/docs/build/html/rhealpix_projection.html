

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The rhealpix_projection Module &mdash; scenzgrid-dggs 0.4 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="scenzgrid-dggs 0.4 documentation" href="index.html" />
    <link rel="next" title="The rhealpix_dggs Module" href="rhealpix_dggs.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rhealpix_dggs.html" title="The rhealpix_dggs Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">scenzgrid-dggs 0.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-rhealpix_projection">
<span id="the-rhealpix-projection-module"></span><h1>The rhealpix_projection Module<a class="headerlink" href="#module-rhealpix_projection" title="Permalink to this headline">¶</a></h1>
<p>This Python 2.7 code implements the HEALPix and rHEALPix map projections.</p>
<p>CHANGELOG:</p>
<ul class="simple">
<li>Alexander Raichev (AR), 2011-09-27: Split projection functions and pixelation 
functions into separate files.</li>
<li>AR, 2011-10-04: Tidied a little. Improved variable names.</li>
<li>AR, 2011-10-06: Added more examples and more default arguments.</li>
<li>AR, 2011-10-23: Added more error-checking, such as the function in_image().</li>
<li>AR, 2012-03-07: Changed &#8216;rot&#8217; to &#8216;ROTATE&#8217;.</li>
<li>AR, 2012-03-23: Fixed a conceptual bug in combine_caps() and get_cap(). Now polar caps actually assemble on top of the caps numbered north_square and south_square.</li>
<li>AR, 2012-03-26: Changed in_image() to accept a radius argument.</li>
<li>AR, 2012-04-16: Imported NumPy instead of SciPy.</li>
<li>AR, 2012-06-13: Simplified get_cap() to cap() and simplified combine_caps().</li>
<li>AR, 2012-07-10: Corrected a subtle longitude rounding error in healpix_sphere(inverse=True).</li>
<li>AR, 2012-08-31: Redefined the projections for only the unit sphere and 
the ellipsoid with eccentricity e and authalic sphere equal to the unit
sphere. Will handle scaling of spheres/ellipsoids in grids.py  
instead. This simplifies the code and puts it more in line with proj4
design, which also deals with scaling as a pre-/post-processing step outside
of the projection definitions.</li>
<li>AR, 2012-09-03: Corrected WGS84_f, the WGS84 ellipsoid flattening factor.</li>
<li>AR, 2013-01-14: Added a radians keyword option to auth_lat().</li>
<li>AR, 2013-01-17: Changed standardize_lon() and standardize_lat() to wrap_longitude() and wrap_latitude(), respectively, and corrected wrap_latitude(). Added lat_0 functionality to healpix() and rhealpix().</li>
</ul>
<p>NOTE:</p>
<p>All lengths are measured in meters and all angles are measured in radians 
unless indicated otherwise.</p>
<p>The projections herein work only for ellipsoids of revolution. 
By &#8216;ellipsoid&#8217; throughout, i mean an ellipsoid of revolution and <em>not</em> a general (triaxial) ellipsoid.
Points lying on the plane are given in rectangular (horizontal, vertical) coordinates, and points lying on the ellipsoid are given in geodetic (longitude, latitude) coordinates unless indicated otherwise.</p>
<p>Except when manipulating positive integers, I avoid the modulo function &#8216;%&#8217; 
and insted write everything in terms of &#8216;floor()&#8217;.
This is because Python interprets the sign of &#8216;%&#8217; differently than
Java or C, and I don&#8217;t want to confuse people who are translating this code
to those languages.</p>
<p>EXAMPLES:</p>
<p>The HEALPix projection of the unit sphere:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">healpix_sphere</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">);</span> <span class="k">print</span> <span class="n">q</span>
<span class="go">(0.049182306619040661, 0.83458047001648894)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">healpix_sphere_inverse</span><span class="p">(</span><span class="o">*</span><span class="n">q</span><span class="p">),</span> <span class="n">p</span>
<span class="go">(1.1102230246251565e-16, 0.78539816339744817) (0, 0.7853981633974483)</span>
</pre></div>
</div>
<p>The (1, 2)-rHEALPix projection of the ellipsoid with eccentricity 0.1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">rhealpix_ellipsoid</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">north_square</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">south_square</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">q</span>
<span class="go">(-0.046205645463128331, 0.83160380886057661)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">rhealpix_ellipsoid_inverse</span><span class="p">(</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">north_square</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">south_square</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">),</span> <span class="n">p</span>
<span class="go">(0.0, 0.7853981629879585) (0, 0.7853981633974483)</span>
</pre></div>
</div>
<dl class="function">
<dt id="rhealpix_projection.cap">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">cap</tt><big>(</big><em>x</em>, <em>y</em>, <em>north_square=0</em>, <em>south_square=0</em>, <em>inverse=False</em><big>)</big><a class="headerlink" href="#rhealpix_projection.cap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of the polar cap and region that <cite>(x, y)</cite> lies in.
If <cite>inverse</cite> = False, then assume <cite>(x,y)</cite> lies in the image of the HEALPix 
projection of the unit sphere.
If <cite>inverse</cite> = True, then assume <cite>(x,y)</cite> lies in the image of the 
<cite>(north_square, south_square)</cite>-rHEALPix projection of the unit sphere.</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>x, y</cite> - Coordinates in the HEALPix or rHEALPix (if <cite>inverse</cite> = True) 
projection of the unit sphere.</li>
<li><cite>north_square, south_square</cite> - Integers between 0 and 3 indicating the 
positions of the north_square pole square and south_square pole square 
respectively.
See rhealpix_sphere() docstring for a diagram.</li>
<li><cite>inverse</cite> - (Optional; default = False) Boolean. If False, then compute
forward function. If True, then compute inverse function.</li>
</ul>
<p>OUTPUT:</p>
<p>The pair (cap_number, region).
Here region equals &#8216;north_square&#8217; (polar), &#8216;south_square&#8217; (polar), or 
&#8216;equatorial&#8217;, indicating where <cite>(x, y)</cite> lies.
If region = &#8216;equatorial&#8217;, then cap_number = None.
Suppose now that region != &#8216;equatorial&#8217;.
If <cite>inverse</cite> = False, then cap_number is the number (= 0, 1, 2, or 3) of 
the HEALPix polar cap Z that <cite>(x, y)</cite> lies in.
If <cite>inverse</cite> = True, then cap_number is the number (= 0, 1, 2, or 3) of 
the HEALPix polar cap that <cite>(x, y)</cite> will get moved into.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cap</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="go">(1, &#39;north_square&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cap</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1, &#39;north_square&#39;)</span>
</pre></div>
</div>
<p>NOTE:</p>
<p>In the HEALPix projection, the polar caps are labeled 0&#8211;3 from 
east to west like this:</p>
<div class="highlight-python"><pre>    *       *       *       *       
  * 0 *   * 1 *   * 2 *   * 3 *        
*-------*-------*-------*-------*
|       |       |       |       |
|       |       |       |       |
|       |       |       |       |
*-------*-------*-------*-------*
  * 0 *   * 1 *   * 2 *   * 3 *
    *       *       *       *</pre>
</div>
<p>In the rHEALPix projection these polar caps get rearranged
into a square with the caps numbered <cite>north_square</cite> and <cite>south_square</cite> 
remaining fixed.
For example, if <cite>north_square</cite> = 1 and <cite>south_square</cite> = 3, then the caps 
get rearranged this way:</p>
<div class="highlight-python"><pre>North polar square:     *-------*       
                        | * 3 * |    
                        | 0 * 2 |    
                        | * 1 * |    
                    ----*-------*----
                    
South polar square: ----*-------*----
                        | * 3 * |
                        | 2 * 0 |
                        | * 1 * |
                        *-------*    </pre>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.combine_caps">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">combine_caps</tt><big>(</big><em>x</em>, <em>y</em>, <em>north_square=0</em>, <em>south_square=0</em>, <em>inverse=False</em><big>)</big><a class="headerlink" href="#rhealpix_projection.combine_caps" title="Permalink to this definition">¶</a></dt>
<dd><p>Rearrange point <cite>(x, y)</cite> in the HEALPix projection by 
combining the polar caps into two polar squares.
Put the north polar square in position <cite>north_square</cite> and 
the south polar square in position <cite>south_square</cite>.
If <cite>inverse</cite> = True, uncombine the polar caps.</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>x, y</cite> - Coordinates in the HEALPix projection of the unit sphere.</li>
<li><cite>north_square, south_square</cite> - Integers between 0 and 3 indicating 
the positions of the north_square polar square and south_square polar 
square respectively.
See rhealpix_sphere() docstring for a diagram.</li>
<li><cite>inverse</cite> - (Optional; default = False) Boolean. If False, then compute
forward function. If True, then compute inverse function.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">combine_caps</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="go">(-1.8325957145940459, 1.5707963267948966)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combine_caps</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>
<span class="go">(-0.78539816339744828, 1.0471975511965976)</span>
<span class="go">(-0.7853981633974483, 1.0471975511965976)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.healpix_diagram">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">healpix_diagram</tt><big>(</big><em>ellipsoid</em>, <em>shade_polar_region=True</em><big>)</big><a class="headerlink" href="#rhealpix_projection.healpix_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Sage Graphics object diagramming the HEALPix projection
boundary and polar triangles for the given ellipsoid.
Inessential graphics method.
Requires Sage graphics methods.</p>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.healpix_ellipsoid">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">healpix_ellipsoid</tt><big>(</big><em>lam</em>, <em>phi</em>, <em>e=0.5</em><big>)</big><a class="headerlink" href="#rhealpix_projection.healpix_ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the signature functions of the HEALPix projection of an oblate
ellipsoid with eccentricity <cite>e</cite> whose authalic sphere is the unit sphere.</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>lam, phi</cite> - Geodetic longitude-latitude coordinates in radians.
Assume -pi &lt;= <cite>lam</cite> &lt; pi and -pi/2 &lt;= <cite>phi</cite> &lt;= pi/2.</li>
<li><cite>e</cite> - Eccentricity of the oblate ellipsoid.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">healpix_ellipsoid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0.51115723774642163)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">healpix_ellipsoid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(0, 0.43414331584208921)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.healpix_ellipsoid_inverse">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">healpix_ellipsoid_inverse</tt><big>(</big><em>x</em>, <em>y</em>, <em>e=0.5</em><big>)</big><a class="headerlink" href="#rhealpix_projection.healpix_ellipsoid_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the inverse of healpix_ellipsoid().</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">healpix_ellipsoid</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">healpix_ellipsoid_inverse</span><span class="p">(</span><span class="o">*</span><span class="n">q</span><span class="p">),</span> <span class="n">p</span>
<span class="go">(0, 0.4482002638024995) (0, 0.4487989505128276)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.healpix_sphere">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">healpix_sphere</tt><big>(</big><em>lam</em>, <em>phi</em><big>)</big><a class="headerlink" href="#rhealpix_projection.healpix_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the signature function of the HEALPix 
projection of the unit sphere.</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>lam, phi</cite> - Geodetic longitude-latitude coordinates in radians.
Assume -pi &lt;= <cite>lam</cite> &lt; pi and -pi/2 &lt;= <cite>phi</cite> &lt;= pi/2.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">healpix_sphere</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arcsin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.healpix_sphere_inverse">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">healpix_sphere_inverse</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#rhealpix_projection.healpix_sphere_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the inverse of the healpix_sphere().</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>x, y</cite> - Planar coordinates in meters in the image of the
HEALPix projection of the unit sphere.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">healpix_sphere_inverse</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arcsin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.healpix_vertices">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">healpix_vertices</tt><big>(</big><em>ellipsoid</em><big>)</big><a class="headerlink" href="#rhealpix_projection.healpix_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the planar vertices of the HEALPix projection of this 
ellipsoid.  Enumerate the vertices starting from the rightmost and 
uppermost vertex and continue anticlockwise.</p>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.in_image">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">in_image</tt><big>(</big><em>x</em>, <em>y</em>, <em>proj='healpix'</em>, <em>north_square=0</em>, <em>south_square=0</em><big>)</big><a class="headerlink" href="#rhealpix_projection.in_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if <cite>(x, y)</cite> lies in the image of the projection <cite>proj</cite>
of the unit sphere, where <cite>proj</cite> is either
&#8216;healpix&#8217; or &#8216;rhealpix&#8217; and <cite>north_square</cite> and <cite>south_square</cite> 
indicate the positions of the polar squares in case <cite>proj</cite> = 
&#8216;rhealpix&#8217;.
Return False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c"># Test boundary points.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">hp</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_image</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">print</span> <span class="s">&#39;Fail&#39;</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c"># Test boundary points.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">north_square</span><span class="p">,</span> <span class="n">south_square</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhp</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="n">north_square</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="n">north_square</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="p">(</span><span class="n">north_square</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="p">(</span><span class="n">north_square</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="n">pi</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="p">(</span><span class="n">south_square</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="p">(</span><span class="n">south_square</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="n">south_square</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">+</span> <span class="n">south_square</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="o">-</span><span class="n">pi</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">eps</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">rhp</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_image</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="s">&#39;rhealpix&#39;</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">print</span> <span class="s">&#39;Fail&#39;</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">proj</span><span class="o">=</span><span class="s">&#39;rhealpix_sphere&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="s">&#39;rhealpix&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.rhealpix_diagram">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">rhealpix_diagram</tt><big>(</big><em>ellipsoid</em>, <em>north_square=0</em>, <em>south_square=0</em>, <em>shade_polar_region=True</em><big>)</big><a class="headerlink" href="#rhealpix_projection.rhealpix_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Sage Graphics object diagramming the rHEALPix projection
boundary and polar triangles for the given ellipsoid.
Inessential graphics method.
Requires Sage graphics methods.</p>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.rhealpix_ellipsoid">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">rhealpix_ellipsoid</tt><big>(</big><em>lam</em>, <em>phi</em>, <em>e=0.5</em>, <em>north_square=0</em>, <em>south_square=0</em><big>)</big><a class="headerlink" href="#rhealpix_projection.rhealpix_ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the signature functions of the rHEALPix map 
projection of an oblate ellipsoid with eccentricity <cite>e</cite> whose 
authalic sphere is the unit sphere. 
The north polar square is put in position <cite>north_square</cite>, 
and the south polar square is put in position <cite>south_square</cite>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>lam, phi</cite> - Geographic longitude-latitude coordinates in radian.
Assume -pi &lt;= <cite>lam</cite> &lt; pi and -pi/2 &lt;= <cite>phi</cite> &lt;= pi/2.</li>
<li><cite>e</cite> - Eccentricity of the ellipsoid.</li>
<li><cite>north_square, south_square</cite> - (Optional; defaults = 0, 0) Integers 
between 0 and 3 indicating positions of north polar and 
south polar squares, respectively.
See rhealpix_sphere() docstring for a diagram.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">rhealpix_ellipsoid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arcsin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(0, 0.69909775214742487)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.rhealpix_ellipsoid_inverse">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">rhealpix_ellipsoid_inverse</tt><big>(</big><em>x</em>, <em>y</em>, <em>e=0.5</em>, <em>north_square=0</em>, <em>south_square=0</em><big>)</big><a class="headerlink" href="#rhealpix_projection.rhealpix_ellipsoid_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the inverse of rhealpix_ellipsoid.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">rhealpix_ellipsoid</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">rhealpix_ellipsoid_inverse</span><span class="p">(</span><span class="o">*</span><span class="n">q</span><span class="p">),</span> <span class="n">p</span>
<span class="go">(0, 0.78512652358127166) (0, 0.7853981633974483)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.rhealpix_sphere">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">rhealpix_sphere</tt><big>(</big><em>lam</em>, <em>phi</em>, <em>north_square=0</em>, <em>south_square=0</em><big>)</big><a class="headerlink" href="#rhealpix_projection.rhealpix_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the signature functions of the rHEALPix map projection of 
the unit sphere. 
The north polar square is put in position <cite>north_square</cite>, and the 
south polar square is put in position <cite>south_square</cite>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><cite>lam, phi</cite> -Geographic longitude-latitude coordinates in radians.
Assume -pi &lt;= <cite>lam</cite> &lt; pi and -pi/2 &lt;= <cite>phi</cite> &lt;= pi/2.</li>
<li><cite>north_square, south_square</cite> - (Optional; defaults = 0, 0) Integers 
between 0 and 3 indicating positions of north polar and 
south polar squares, respectively.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">rhealpix_sphere</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(-1.6199786334139372, 2.3070121835733044)</span>
</pre></div>
</div>
<p>NOTE:</p>
<p>The polar squares are labeled 0, 1, 2, 3 from east to west like this:</p>
<div class="highlight-python"><pre>east         west        
*---*---*---*---*
| 0 | 1 | 2 | 3 |
*---*---*---*---*
|   |   |   |   |
*---*---*---*---*
| 0 | 1 | 2 | 3 |
*---*---*---*---*    </pre>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.rhealpix_sphere_inverse">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">rhealpix_sphere_inverse</tt><big>(</big><em>x</em>, <em>y</em>, <em>north_square=0</em>, <em>south_square=0</em><big>)</big><a class="headerlink" href="#rhealpix_projection.rhealpix_sphere_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the inverse of rhealpix_sphere().</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">rhealpix_sphere</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">rhealpix_sphere_inverse</span><span class="p">(</span><span class="o">*</span><span class="n">q</span><span class="p">),</span> <span class="n">p</span>
<span class="go">(2.2204460492503131e-16, 0.78539816339744806) (0, 0.7853981633974483)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rhealpix_projection.rhealpix_vertices">
<tt class="descclassname">rhealpix_projection.</tt><tt class="descname">rhealpix_vertices</tt><big>(</big><em>ellipsoid</em>, <em>north_square=0</em>, <em>south_square=0</em><big>)</big><a class="headerlink" href="#rhealpix_projection.rhealpix_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the planar vertices of the HEALPix projection of this 
ellipsoid.  Enumerate the vertices starting from the rightmost and 
uppermost vertex and continue anticlockwise.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rhealpix_dggs.html"
                        title="next chapter">The rhealpix_dggs Module</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/rhealpix_projection.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rhealpix_dggs.html" title="The rhealpix_dggs Module"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="index.html">scenzgrid-dggs 0.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Alexander Raichev.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>